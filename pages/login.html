<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Diamond Page Store</title>
    <script src="../scripts/tailwind.js"></script>
    <script src="../scripts/layout.js"></script>
    <link rel="stylesheet" href="../styles/global.css">
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        (function () {
            const urlParams = new URLSearchParams(window.location.search);
            const role = urlParams.get('role');
            const stage = urlParams.get('stage');
        })();
    </script>
</head>

<body class="bg-brown-cream min-h-screen flex items-center justify-center p-6">
    <div class="max-w-md w-full bg-white rounded-2xl shadow-xl overflow-hidden border border-brown-light/20">
        <div class="p-8">
            <!-- 第一步：身份选择界面 -->
            <div id="identity-section" class="space-y-6">
                <div class="text-center mb-8">
                    <h1 class="text-3xl font-serif font-bold text-brown-dark">Identify Yourself</h1>
                    <p class="text-gray-500 mt-2">Please select your role to continue</p>
                </div>
                <div class="grid grid-cols-1 gap-4">
                    <button id="select-staff"
                        class="group p-6 border-2 border-brown-light/30 rounded-xl hover:border-brown hover:bg-brown/5 transition-all text-left">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-lg font-bold text-brown-dark">Staff Member</h3>
                                <p class="text-sm text-gray-500">Store Manager, Sales, or Finance</p>
                            </div>
                            <i
                                class="fa fa-chevron-right text-brown-light group-hover:text-brown transition-colors"></i>
                        </div>
                    </button>
                    <button id="select-user"
                        class="group p-6 border-2 border-brown-light/30 rounded-xl hover:border-brown hover:bg-brown/5 transition-all text-left">
                        <div class="flex items-center justify-between">
                            <div>
                                <h3 class="text-lg font-bold text-brown-dark">Customer</h3>
                                <p class="text-sm text-gray-500">Shopping, Track Orders, or Register</p>
                            </div>
                            <i
                                class="fa fa-chevron-right text-brown-light group-hover:text-brown transition-colors"></i>
                        </div>
                    </button>
                </div>
            </div>

            <!-- 第二步：认证界面 (初始隐藏) -->
            <div id="auth-section" class="hidden">
                <button id="back-to-identity"
                    class="mb-4 text-sm text-gray-500 hover:text-brown flex items-center gap-1 transition-colors">
                    <i class="fa fa-arrow-left"></i> Back to selection
                </button>

                <div class="text-center mb-8">
                    <h1 id="auth-title" class="text-3xl font-serif font-bold text-brown-dark">Welcome Back</h1>
                    <p id="auth-subtitle" class="text-gray-500 mt-2">Log in using your staff account</p>
                </div>

                <!-- 原有的 login-form 移入此处 -->
                <form id="login-form" class="space-y-5">
                    <div>
                        <label class="block text-sm font-bold text-brown-dark mb-1">Username</label>
                        <input type="text" id="username" required
                            class="w-full px-4 py-3 rounded-lg border border-brown-light focus:ring-2 focus:ring-brown focus:outline-none transition-all"
                            placeholder="Enter your username">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-brown-dark mb-1">Password</label>
                        <div class="relative">
                            <!-- 1. 去掉了 placeholder 里的黑点 -->
                            <!-- 2. 增加了 pr-10 给右侧图标留位置 -->
                            <input type="password" id="password" required
                                class="w-full px-4 py-3 rounded-lg border border-brown-light focus:ring-2 focus:ring-brown focus:outline-none transition-all pr-10"
                                placeholder="Enter your password">

                            <!-- 3. 新增小眼睛按钮 -->
                            <button type="button" id="toggle-password"
                                class="absolute inset-y-0 right-0 px-3 flex items-center text-gray-400 hover:text-brown transition-colors focus:outline-none">
                                <i class="fa fa-eye-slash text-lg"></i>
                            </button>
                        </div>
                    </div>
                    <div id="confirm-password-wrapper" class="hidden">
                        <label class="block text-sm font-bold text-brown-dark mb-1">Confirm Password</label>
                        <input type="password" id="confirm-password"
                            class="w-full px-4 py-3 rounded-lg border border-brown-light focus:ring-2 focus:ring-brown focus:outline-none transition-all"
                            placeholder="••••••••">
                    </div>
                    <button type="submit" id="login-submit-btn"
                        class="w-full bg-brown text-white py-3 rounded-lg font-bold hover:bg-brown-dark transition-all shadow-md active:scale-[0.98] flex justify-center items-center">
                        <span>Sign In</span>
                        <!-- 预留加载状态，初始隐藏 -->
                        <i id="login-spinner" class="fa fa-spinner fa-spin ml-2 hidden"></i>
                    </button>

                    <!-- 注册按钮 -->
                    <p class="text-center text-sm text-gray-500 mt-4">
                        <span id="switch-text">Don't have an account?</span>
                        <a href="javascript:void(0)" id="auth-switch-btn"
                            class="text-brown font-bold hover:underline">Register Now</a>
                    </p>
                </form>
            </div>
        </div>
    </div>
    </div>
    <script src="../scripts/common.js"></script>
    <script src="../scripts/login.js"></script>
</body>

</html>